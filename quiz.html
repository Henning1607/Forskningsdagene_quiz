<!--
Made by Henning Corneliussen in cooperation with
HiOA for Forskningsdagene 2016

**********
TODO/problemer:
**********

- Spørsmål kommer ikke to ganger
- Link for keypress: http://keycode.info/
- Link for buttons: http://usbbuttons.com/
- Hva skal komme opp hvis man ender opp på nøyral??
- Fikse bilde animation

**********
**********

-->
<!DOCTYPE html>
<html>
    <head>
        <title>Forskningsdagene 2016</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="forskningstyle.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    </head>
    <body id="body">
        <div id="nyttSpill">
            <div id="nyttSpillText">Trykk på en av knappene for å starte quizen</div>
            <div id="circle1"></div>
            <div id="circle2"></div>
        </div>
        <div id="ferdig">
                <div id="ferdigText"></div>
            </div>
        <div id="ramme">
            <div id="spmRamme">
                <div id="sporsmal"></div>
            </div>
            <div id="antallRamme">
                <p id="antallSpm"></p>
            </div>
        </div>
        <div id="divbilde">
            <img src="bilder/neutral.png" alt="Bilde av hacking" id="bilde">
        </div>
        <div>
            <img src="bilder/hioa_logo_250px_original_no.png" alt="Bilde av hacking" id="hioa" height="150" width="150">
        </div>

        <script type="text/javascript">
            var ethics = 0;
            $("#ferdig").hide();
            $("body").hide();
            $("#nyttSpill").hide();
            randomSpm(3);
            
            $(document).ready(function() {
                var tall = 0;
                
                $("body").fadeIn(3000);
                $("body").fadeIn(3000, function(){
                    //Code for keypress. This is the X key.
                    $(document).bind('keydown',function(e){
                       if(e.keyCode === 88) {
                           tall++;
                           //Prevents buttons doing anything after quiz has ended
                           if(tall <= 10){
                               //Answer "Yes"
                               randomSpm(1);
                               console.log(tall);
                           }
                       }
                    });

                    //Code for keypress. This is the C key.
                    $(document).bind('keydown',function(e){
                       if(e.keyCode === 67) {
                           tall++;
                           //Prevents buttons doing anything after quiz has ended
                           if(tall <= 10){
                               //Answer "No"
                               randomSpm(2);
                               console.log(tall);
                           }
                       }
                    });
                });
                document.body.style.background=getBackg("neutral");
                $("#bilde").attr("src","bilder/neutral.png");
            });
            
            /*
             * Backgrounds gradients
             */
            function getBackg(bakText){
                var bakHappy2 = "-moz-radial-gradient(center, ellipse cover, rgba(255,210,21,1) 0%, rgba(255,255,255,1) 100%)";
                var bakHappy = "-moz-radial-gradient(center, ellipse cover, rgba(255,210,21,1) 63%, rgba(255,255,255,1) 100%)";
                var bakNeutral = "rgb(255,210,21)";
                var bakSad = "-moz-radial-gradient(center, ellipse cover, rgba(255,210,21,1) 63%, rgba(0,0,0,1) 100%)";
                var bakSad2 = "-moz-radial-gradient(center, ellipse cover, rgba(255,210,21,1) 0%, rgba(0,0,0,1) 100%)";

                if(bakText === "happy2"){
                    return bakHappy2;
                }

                if(bakText === "happy"){
                    return bakHappy;
                }
                
                if(bakText === "neutral"){
                    return bakNeutral;
                }

                if(bakText === "sad"){
                    return bakSad;
                }

                if(bakText === "sad2"){
                    return bakSad2;
                }

            }
            
            /*Changes the background gradient*/
            function fargeEndre(value){
                //Value === 1 is positive case.
                //Value === 2 is negative case.
                if(value === 1){
                    if(ethics < 3) ethics ++;
                }else if(value === 2){
                    if(ethics > -3) ethics --;
                }
                switch(ethics){
                    case -2:
                        $(body).css("background", getBackg("sad"));
                        $("#bilde").attr("src","bilder/sad2.png");
                        break;
                    case -1:
                        $(body).css("background", getBackg("sad"));
                        $("#bilde").attr("src","bilder/sad.png");
                        break;
                    case 0:
                        $(body).css("background", getBackg("neutral"));
                        $("#bilde").attr("src","bilder/neutral.png");
                        break;
                    case 1:
                        $(body).css("background", getBackg("happy"));
                        $("#bilde").attr("src","bilder/happy.png");
                        break;
                    case 2:
                        $(body).css("background", getBackg("happy2"));
                        $("#bilde").attr("src","bilder/happy2.png");
                        break;
                }
                //console.log(ethics);
            }
            
            var res;
            var antall;
            /*
             * Lazy fix to global scope problem.
             */
            function getAntall(){
                antall=0;
                return antall;
            }
            
            /*
             * Random function to get a question.
             * Tall represents the button that has a negative effect on 
             * on the 'ethic'. 
             * */
            function spm(){
                var questions =[
                    {spm: "Kan hacking være positivt?", tall: "Nei"},
                    {spm: "Burde myndighetene få lov til å hacke kriminelle?", tall: "Ja"},
                    {spm: "Burde hacking være ulovlig?", tall: "Ja"},
                    {spm: "Er hacking av myndighetene kult?", tall: "Ja"}
                ];
                var nr = (Math.floor(Math.random() * questions.length) + 0);
                res = questions[nr];
            }
            
            function randomSpm(val){
                //console.log(antall + " Antall");
                if(antall < 10 || antall === 0){
                    sjekkSvar(val);
                    spm();
                    //console.log(res.tall);
                    //console.log(antall + "Antall");
                    $("#sporsmal").fadeOut(1500);
                    $("#sporsmal").fadeOut(1500, function(){
                        //Loads after fadeOut animation is complete
                        $("#sporsmal").html(res.spm);
                        $("#sporsmal").fadeIn(1500);
                    });
                    antall++;
                    $("#antallSpm").html(antall + " av 10");
                } else if(antall >= 10) { //User has finished the quiz
                    sjekkSvar(val);
                    $("#ramme").hide();
                    switch(ethics){
                        case -2:
                        case -1:
                            $("#ferdigText").html("Du ble Black Hat");
                            break;
                        case 0:
                            $("#ferdigText").html("Du ble Nøytral");//Fix this?
                            break;
                        case 1:
                        case 2:
                            $("#ferdigText").html("Du ble White Hat");
                            break;
                    }
                    $("#ferdig").show();
                    $("#ferdig").fadeIn(1500, function(){
                        $("#ferdig").animate({
                            top: '30%',
                            width: '25%',
                            height: '5em',
                            left: '36%'
                        });
                    });
                    $("#nyttSpill").delay(1000).fadeIn(1500);
                    $("#nyttSpill").delay(1000).fadeIn(1500, function(){
                        $(document).bind('keydown',function(e){
                            if(e.keyCode === 67) {
                               location.reload();
                            }
                        });
                         
                        $(document).bind('keydown',function(e){
                            if(e.keyCode === 88) {
                               location.reload();
                            }
                        });
                        $(body).delay(3000).css("background", getBackg("neutral"));
                        $("#divbilde").delay(12000).fadeOut(2000);
                        $("#ferdig").delay(10500).fadeOut(2000);
                        $("#nyttSpill").delay(10000).animate({
                            top: '30%'
                        }, 3500);
                    });
                } else if (!antall){
                    getAntall();
                    randomSpm();
                    //alert("boop");
                }
            }
            
            /*
             * Check to se if a variable is set to res.
             * First time a user runs the quiz, res should be empty.
             */
            function sjekkSvar(alt) {
                if(res){
                    if(res.tall === "Ja"){ //Negative answer is "Ja"
                        if(alt === 1){
                            fargeEndre(2);
                        } else if(alt === 2) {
                            fargeEndre(1);
                        }
                    } else if(res.tall === "Nei") { //Negative answer is "Nei"
                        if(alt === 1){
                            fargeEndre(1);
                        } else if(alt === 2) {
                            fargeEndre(2);
                        }
                    }
                }
            }
        </script>
    </body>
</html>
